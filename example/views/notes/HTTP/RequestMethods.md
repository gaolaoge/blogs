---
title: 请求方法
mode: "notes"
---

HTTP 协议设计时设想是用 HTTP 协议构建一个超链接文档系统，使用 URI 来定位这些文档，也就是资源，还需要有某种**动作的指示**，标记操作这些资源的方式。

**请求方法**的实际含义就是客户端发出了一个“动作指令”，要求服务器端对 URI 定位的资源执行这个动作。  

目前 HTTP/1.1 规定了八种方法，单词都必须是大写的形式：

- **GET**：获取资源，对应于资源的读取操作；
- **POST**：创建资源，对应于资源的创建操作；
- **PUT**：更新资源，对应于资源的更新操作；
- **DELETE**：删除资源，对应于资源的删除操作；
- **HEAD**：获取资源的元信息，对应于资源的读取操作；
- **OPTIONS**：获取资源支持的请求方法，对应于资源的读取操作；
- **TRACE**：追踪资源的请求，对应于资源的读取操作；
- **CONNECT**：建立一个 TCP 连接，对应于资源的读取操作。


这些方法类似于对文件或数据库的“增删改查”操作，只不过这些动作操作的目标是远程服务器上的资源，只能由客户端**请求**或者**指示**服务器来完成。

客户端没有动作执行的最终决定权，服务器掌控着所有资源，拥有绝对的决策权力。  
它收到 HTTP 请求报文后，可以执行也可以拒绝，或者改变动作的含义，毕竟 HTTP 只是一个**协议**。

**GET/HEAD**

GET 的含义是请求从服务器获取资源，这个资源既可以是静态的文本、页面、图片、视频，也可以是由 PHP、Java 动态生成的页面或者其他格式的数据。

搭配 URI 和其他头字段能实现对资源更精细的操作。如，在 URI 后使用“#”，就可以在获取页面后直接定位到某个标签所在的位置；使用 If-Modified-Since 字段就变成了“有条件的请求”，仅当资源被修改时才会执行获取动作；使用 Range 字段就是“范围请求”，只获取资源的一部分数据。

HEAD 方法与 GET 方法类似，但服务器不会返回请求的实体数据，只会传回响应头，也就是资源的“元信息”。可以用于请求体数据庞大时验证请求的响应是否会成功，避免传输 body 数据的浪费。

```http
GET /10-1 HTTP/1.1
Host: www.chrono.com


HEAD /10-1 HTTP/1.1
Host: www.chrono.com
```

**POST/PUT**

POST 和 PUT 方法向 URI 指定的资源提交数据，数据就放在报文的 body 里。

通常 POST 表示的是“新建”“create”的含义，而 PUT 则是“修改”“update”的含义。

```http
POST /10-2 HTTP/1.1
Host: www.chrono.com
Content-Length: 17

POST DATA IS HERE

PUT /10-2 HTTP/1.1
Host: www.chrono.com
Content-Length: 16

PUT DATA IS HERE
```

**DELETE**

DELETE 方法指示服务器删除资源，因为这个动作危险性太大，所以通常服务器不会执行真正的删除操作，而是对资源做一个删除标记。
```http
DELETE /10-3 HTTP/1.1
Host: www.chrono.com
```

**OPTIONS**

OPTIONS 方法要求服务器列出可对资源实行的操作方法，在响应头的 Allow 字段里返回。它的功能很有限，用处也不大，有的服务器（例如 Nginx）干脆就没有实现对它的支持。

**TRACE**

TRACE 方法多用于对 HTTP 链路的测试或诊断，可以显示出请求 - 响应的传输路径。它的本意是好的，但存在漏洞，会泄漏网站的信息，所以 Web 服务器通常也是禁止使用。

**CONNECT**

CONNECT 是一个比较特殊的方法，要求服务器为客户端和另一台远程服务器建立一条特殊的连接隧道，这时 Web 服务器在中间充当了代理的角色。

### 安全与幂等

**安全**与**幂等**是两个比较重要的概念。

在 HTTP 协议里，**安全**是指请求方法不会“破坏”服务器上的资源，即不会对服务器上的资源造成实质的修改。

按照这个定义，只有 GET 和 HEAD 方法是**安全**的，因为它们是“只读”操作。

**幂等**实际上是一个数学用语，被借用到了 HTTP 协议里，意思是多次执行相同的操作，结果也都是相同的，即多次“幂”后结果“相等”。

GET 和 HEAD 既是安全的也是幂等的，DELETE 可以多次删除同一个资源，效果都是“资源不存在”，所以也是幂等的。

POST 和 PUT 的幂等性质就略费解一点。按照 RFC 里的语义，POST 是“新增或提交数据”，多次提交数据会创建多个资源，所以不是幂等的；而 PUT 是“替换或更新数据”，多次更新一个资源，资源还是会第一次更新的状态，所以是幂等的。

> 这里可以对比一下 SQL 来加深理解：把 POST 理解成 INSERT，把 PUT 理解成 UPDATE，这样就很清楚了。多次 INSERT 会添加多条记录，而多次 UPDATE 只操作一条记录，而且效果相同。
